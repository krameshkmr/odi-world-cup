---
title: "ODI-2"
output: html_document
date: "2023-03-19"
---

```{r setup, include=FALSE}
library(tidyverse)
library(knitr)
library(tinytex)
library(cricketdata)

knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(out.width = "60%",fig.align='center')
```

```{r}
wc_player_data <- read.csv("~/Downloads/player_data.csv")
```

```{r}
odi_matches <- fetch_cricsheet("match", "male", "odis")
odi_players <- fetch_cricsheet("player", "male", "odis")
wc_matches <- odi_matches %>% filter(event %in% c("ICC World Cup", "ICC Cricket World Cup", "World Cup"))
```

```{r}
top_order_runs <- wc_player_data %>% group_by(match_id) %>% 
                                     filter(Pos %in% c(1, 2, 3)) %>% 
                                     summarize(inns_1 = sum(Runs[Inns == 1], na.rm = TRUE), 
                                               inns_2 = sum(Runs[Inns == 2], na.rm = TRUE))

middle_order_runs <- wc_player_data %>% group_by(match_id) %>% 
                                        filter(Pos %in% c(4, 5, 6, 7)) %>% 
                                        summarize(inns_1 = sum(Runs[Inns == 1], na.rm = TRUE), 
                                                  inns_2 = sum(Runs[Inns == 2], na.rm = TRUE))
```

```{r}
top_order_mins <- wc_player_data %>% group_by(match_id) %>% 
                                     filter(Pos %in% c(1, 2, 3)) %>% 
                                     summarize(inns_1 = sum(Mins[Inns == 1], na.rm = TRUE), 
                                               inns_2 = sum(Mins[Inns == 2], na.rm = TRUE))

middle_order_mins <- wc_player_data %>% group_by(match_id) %>% 
                                        filter(Pos %in% c(4, 5, 6, 7)) %>% 
                                        summarize(inns_1 = sum(Mins[Inns == 1], na.rm = TRUE), 
                                                  inns_2 = sum(Mins[Inns == 2], na.rm = TRUE))
```

```{r}
top_order_bf <- wc_player_data %>% group_by(match_id) %>% 
                                   filter(Pos %in% c(1, 2, 3)) %>% 
                                   summarize(inns_1 = sum(BF[Inns == 1], na.rm = TRUE), 
                                             inns_2 = sum(BF[Inns == 2], na.rm = TRUE))

middle_order_bf <- wc_player_data %>% group_by(match_id) %>% 
                                      filter(Pos %in% c(4, 5, 6, 7)) %>% 
                                      summarize(inns_1 = sum(BF[Inns == 1], na.rm = TRUE), 
                                                inns_2 = sum(BF[Inns == 2], na.rm = TRUE))
```

```{r}
top_order_x4 <- wc_player_data %>% group_by(match_id) %>% 
                                   filter(Pos %in% c(1, 2, 3)) %>% 
                                   summarize(inns_1 = sum(X4s[Inns == 1], na.rm = TRUE), 
                                             inns_2 = sum(X4s[Inns == 2], na.rm = TRUE))

middle_order_x4 <- wc_player_data %>% group_by(match_id) %>% 
                                      filter(Pos %in% c(4, 5, 6, 7)) %>% 
                                      summarize(inns_1 = sum(X4s[Inns == 1], na.rm = TRUE), 
                                                inns_2 = sum(X4s[Inns == 2], na.rm = TRUE))
```

```{r}
top_order_x6 <- wc_player_data %>% group_by(match_id) %>% 
                                   filter(Pos %in% c(1, 2, 3)) %>% 
                                   summarize(inns_1 = sum(X6s[Inns == 1], na.rm = TRUE), 
                                             inns_2 = sum(X6s[Inns == 2], na.rm = TRUE))

middle_order_x6 <- wc_player_data %>% group_by(match_id) %>% 
                                      filter(Pos %in% c(4, 5, 6, 7)) %>% 
                                      summarize(inns_1 = sum(X6s[Inns == 1], na.rm = TRUE), 
                                                inns_2 = sum(X6s[Inns == 2], na.rm = TRUE))
```

```{r}
top_order_SR <- wc_player_data %>% group_by(match_id) %>% 
                                   filter(Pos %in% c(1, 2, 3)) %>% 
                                   summarize(inns_1 = mean(SR[Inns == 1], na.rm = TRUE), 
                                             inns_2 = mean(SR[Inns == 2], na.rm = TRUE))

middle_order_SR <- wc_player_data %>% group_by(match_id) %>% 
                                      filter(Pos %in% c(4, 5, 6, 7)) %>% 
                                      summarize(inns_1 = mean(SR[Inns == 1], na.rm = TRUE), 
                                                inns_2 = mean(SR[Inns == 2], na.rm = TRUE))
```

```{r}
temp <- wc_matches %>% filter(!is.na(wc_matches$winner_wickets))
```


```{r}
wc_matches$winner_wickets <- as.numeric(wc_matches$winner_wickets)
```

```{r}
wc_matches %>% filter(!is.na(winner_wickets)) %>% 
  select(match_id, winner_wickets) %>% 
  summarize(wickets_left = (10 - winner_wickets))
```

